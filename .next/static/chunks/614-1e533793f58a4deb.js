"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[614],{7774:function(e,t,s){s.r(t),s.d(t,{default:function(){return N}});var r=s(3827),a=s(4090),l=s(7908),n=s(6358);let i={tableTitle:"Liste des utilisateurs",columns:["Nom","Pr\xe9nom","Email","Role","Actions"],tableData:e=>[e.firstName,e.lastName,e.email,e.userRole,"Actions"],addNewButtonLabel:"Ajouter un utilisateur",modalDelete:{title:"Suppression d'un utilisateur",body:"Voulez-vous vraiment supprimer cet utilisateur ?",confirmLabel:"Supprimer",cancelLabel:"Annuler"}},o={tableTitle:"Liste des produits",columns:["Titre","Description","Prix","Owner","Cr\xe9ateur","Actions"],tableData:e=>[e.title,e.description,e.price,"".concat(e.owner.firstName," ").concat(e.owner.lastName),"".concat(e.userId.firstName," ").concat(e.userId.lastName),"Actions"],addNewButtonLabel:"Ajouter un produit",modalDelete:{title:"Suppression d'un produit",body:"Voulez-vous vraiment supprimer ce produit ?",confirmLabel:"Supprimer",cancelLabel:"Annuler"}},c=e=>{switch(e){case n.g.Users:return i;case n.g.Products:return o;default:throw Error("Invalid data type")}},d=e=>{let{title:t,body:s,confirmFn:a,cancelFn:l,confirmLabel:n,children:i}=e;return(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-headline",children:t}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:s})}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:i})})]})})}),(0,r.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:()=>a(),className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",children:n}),(0,r.jsx)("button",{type:"button",onClick:()=>l(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Annuler"})]})]})]})})},m=async(e,t)=>{try{return await l.Z.post("".concat("https://app-7d961364-9019-41e1-906d-4eb58bdf89c4.cleverapps.io/api","/").concat("users"===e?"users":"products"),t,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("userToken"))}})}catch(e){console.error("Error saving item:",e)}},u=async(e,t)=>{try{return await l.Z.put("".concat("https://app-7d961364-9019-41e1-906d-4eb58bdf89c4.cleverapps.io/api","/").concat("users"===e?"users":"products","/").concat(t._id),t,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("userToken"))}})}catch(e){console.error("Error saving item:",e)}},p=async(e,t)=>{try{return l.Z.delete("".concat("https://app-7d961364-9019-41e1-906d-4eb58bdf89c4.cleverapps.io/api","/").concat("users"===e?"users":"products","/").concat(t._id),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("userToken"))}})}catch(e){console.error("Error deleting item:",e)}};var h=s(8598),x=s(88),f=s(6683),b=s(7489),g=e=>{let{title:t,handleSubmit:s,confirmText:l,handleClose:n,selectedItem:i}=e,o=localStorage.getItem("userId"),c=localStorage.getItem("userRole"),[d,m]=(0,a.useState)([]),u=(0,a.useCallback)(async()=>{try{let e=await (0,b.AW)();m(e)}catch(e){console.error("Error fetching data:",e)}},[]);return(0,a.useEffect)(()=>{u()},[u]),(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-5",id:"modal-headline",children:t}),(0,r.jsx)(h.l0,{onSubmit:s,initialValues:i,validate:f.$,render:e=>{let{handleSubmit:t,form:s,submitting:a,pristine:i,values:m}=e;return(0,r.jsxs)("form",{onSubmit:t,className:"space-y-4 w-full",children:[(0,r.jsx)(h.gN,{name:"userId",component:"input",type:"hidden",defaultValue:o}),(0,r.jsx)(h.gN,{name:"title",component:x.T,type:"text",placeholder:"Titre"}),(0,r.jsx)(h.gN,{name:"description",component:x.T,type:"text",placeholder:"Description"}),(0,r.jsx)(h.gN,{name:"price",component:x.T,type:"number",placeholder:"Prix"}),"admin"===c?(0,r.jsxs)(h.gN,{name:"owner",component:"select",className:"select select-bordered w-full",placeholder:"Assigner \xe0 l'utilisateur",children:[(0,r.jsx)("option",{value:"",children:"S\xe9lectionner un utilisateur"}),d.map(e=>(0,r.jsxs)("option",{value:e._id,children:[e.firstName," ",e.lastName]},e._id))]}):(0,r.jsx)(h.gN,{name:"owner",component:"input",type:"hidden",defaultValue:o}),(0,r.jsxs)("div",{className:"flex justify-end",children:[(0,r.jsx)("button",{type:"button",onClick:()=>n(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Fermer"}),(0,r.jsx)("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:l})]})]})}})]})})})})]})})},j=e=>{let{title:t,handleSubmit:s,confirmText:a,handleClose:l,mode:n,selectedItem:i}=e;return(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,r.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,r.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[(0,r.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-5",id:"modal-headline",children:t}),(0,r.jsx)(h.l0,{onSubmit:s,initialValues:i,validate:f.M,render:e=>{let{handleSubmit:t}=e;return(0,r.jsxs)("form",{onSubmit:t,className:"space-y-4 w-full",children:[(0,r.jsx)(h.gN,{name:"firstName",component:x.T,type:"text",placeholder:"Pr\xe9nom"}),(0,r.jsx)(h.gN,{name:"lastName",component:x.T,type:"text",placeholder:"Nom"}),(0,r.jsx)(h.gN,{name:"email",component:x.T,type:"email",placeholder:"Email"}),"add"===n&&(0,r.jsx)(h.gN,{name:"password",component:x.T,type:"password",placeholder:"Mot de passe"}),(0,r.jsxs)(h.gN,{name:"userRole",component:"select",placeholder:"R\xf4le",className:"select select-bordered w-full mb-4",children:[(0,r.jsx)("option",{disabled:!0,value:"",children:"S\xe9lectionnez votre r\xf4le"}),(0,r.jsx)("option",{value:"user",children:"Utilisateur"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]}),(0,r.jsxs)("div",{className:"flex justify-end",children:[(0,r.jsx)("button",{type:"button",onClick:()=>l(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Fermer"}),(0,r.jsx)("button",{type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:a})]})]})}})]})})})})]})})},N=e=>{let{dataType:t,showFilter:s}=e,[i,o]=(0,a.useState)([]),[h,x]=(0,a.useState)([]),[f,N]=(0,a.useState)(""),[y,w]=(0,a.useState)(!1),[v,k]=(0,a.useState)(""),[S,C]=(0,a.useState)(null),A=c(t),T=t===n.g.Users&&1===i.length,E=f?i.filter(e=>e.owner._id===f):i,R=(e,t)=>{k(e),w(!0),C(t||null)},I=(0,a.useCallback)(async()=>{try{let e=await (0,b.AW)();x(e)}catch(e){console.error("Error fetching users:",e)}},[]),z=(0,a.useCallback)(async()=>{try{let e=t===n.g.Users?"users":"products";await l.Z.get("".concat("https://app-7d961364-9019-41e1-906d-4eb58bdf89c4.cleverapps.io/api","/").concat(e),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("userToken"))}}).then(e=>o(e.data[t]))}catch(e){console.error("Error fetching data:",e)}},[t]),L=(0,a.useCallback)(async e=>{try{await m(t,e),w(!1),z()}catch(e){console.error("Error post item:",e)}},[t,z]),_=(0,a.useCallback)(async e=>{try{await u(t,e),w(!1),z()}catch(e){console.error("Error editing item:",e)}},[t,z]),D=(0,a.useCallback)(async e=>{try{await p(t,e),w(!1),z()}catch(e){console.error("Error deleting item:",e)}},[t,z]);return(0,a.useEffect)(()=>{z(),I()},[z,I]),(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between pb-8",children:[(0,r.jsx)("h1",{className:"text-xl font-bold mb-4",children:A.tableTitle}),t===n.g.Products&&s&&(0,r.jsxs)("label",{className:"form-control w-full max-w-xs",children:[(0,r.jsx)("div",{className:"label flex justify-end",children:(0,r.jsx)("span",{className:"label-text",children:"Filtrer les produits qui appartienne \xe0 un utilisateur"})}),(0,r.jsxs)("select",{className:"select select-bordered",onChange:e=>{console.log(e.target.value),N(e.target.value)},children:[(0,r.jsx)("option",{value:"",children:"Tous les utilisateurs"}),h.map(e=>(0,r.jsxs)("option",{value:e._id,children:[e.firstName," ",e.lastName]},e._id))]})]})]}),(t===n.g.Products?E:i).length>0?(0,r.jsxs)("table",{className:"table-auto w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsx)("tr",{children:A.columns.map(e=>(0,r.jsx)("th",{children:e},e))})}),(0,r.jsx)("tbody",{children:i.map(e=>{let t=A.tableData(e);return(0,r.jsx)("tr",{children:t.map((s,a)=>a===t.length-1?(0,r.jsxs)("td",{children:[(0,r.jsx)("button",{className:"btn btn-blue mr-2",onClick:()=>R("edit",e),children:"Editer"}),(0,r.jsx)("button",{className:"btn btn-red",disabled:T,onClick:()=>R("delete",e),children:"Supprimer"})]},a):(0,r.jsx)("td",{children:s},a))},e._id)})})]}):(0,r.jsxs)("div",{role:"alert",className:"alert",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"stroke-info shrink-0 w-6 h-6",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:t===n.g.Products&&"Aucun produit."})]}),(0,r.jsx)("div",{className:"w-full flex justify-end mt-7",children:(0,r.jsx)("button",{className:"btn bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>R("add"),children:A.addNewButtonLabel})}),y&&"add"===v&&(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl",children:(0,r.jsx)("div",{className:"p-4",children:t===n.g.Users?(0,r.jsx)(j,{mode:"add",handleSubmit:L,confirmText:"Ajouter",handleClose:()=>w(!1),title:"Ajouter un profil"}):(0,r.jsx)(g,{handleSubmit:L,confirmText:"Ajouter",handleClose:()=>w(!1),title:"Ajouter un produit"})})})})}),y&&"edit"===v&&S&&(0,r.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl",children:(0,r.jsx)("div",{className:"p-4",children:t===n.g.Users?(0,r.jsx)(j,{mode:"edit",selectedItem:S,handleSubmit:_,confirmText:"Editer",handleClose:()=>w(!1),title:"Editer un profil"}):(0,r.jsx)(g,{selectedItem:S,handleSubmit:_,confirmText:"Editer",handleClose:()=>w(!1),title:"Editer un produit"})})})})}),y&&"delete"===v&&S&&(0,r.jsx)(d,{title:A.modalDelete.title,body:A.modalDelete.body,confirmLabel:A.modalDelete.confirmLabel,confirmFn:()=>D(S),cancelFn:w})]})}},88:function(e,t,s){s.d(t,{T:function(){return a}});var r=s(3827);s(4090);let a=e=>{let{input:t,meta:s,placeholder:a,type:l}=e;return(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("input",{...t,type:l,placeholder:a,className:"input input-bordered w-full ".concat(s.error&&s.touched?"input-error":"")}),s.error&&s.touched&&(0,r.jsx)("span",{className:"text-xs text-error",children:s.error})]})}},6358:function(e,t,s){var r,a;s.d(t,{g:function(){return r}}),(a=r||(r={})).Users="users",a.Products="products"},7489:function(e,t,s){s.d(t,{AW:function(){return l},Dg:function(){return a}});var r=s(7908);let a=async()=>{try{return(await r.Z.get("".concat("https://app-7d961364-9019-41e1-906d-4eb58bdf89c4.cleverapps.io/api","/products"))).data.products}catch(e){return console.error("Could not fetch products:",e),[]}},l=async()=>{try{return(await r.Z.get("".concat("https://app-7d961364-9019-41e1-906d-4eb58bdf89c4.cleverapps.io/api","/users"))).data.users}catch(e){return console.error("Could not fetch users:",e),[]}}},6683:function(e,t,s){s.d(t,{$:function(){return a},M:function(){return r}});let r=e=>{let t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.email)||(t.email="Invalid email address"):t.email="Required",e.password?e.password.length<8&&(t.password="Password must be at least 8 characters"):t.password="Required",e.firstName||(t.firstName="Required"),e.lastName||(t.lastName="Required"),e.userRole||(t.userRole="Required"),t},a=e=>{let t={};return e.title||(t.title="Required"),e.description||(t.description="Required"),null==e.price?t.price="Required":0>=Number(e.price)&&(t.price="Price must be greater than 0"),t}}}]);